<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE GVAdapters SYSTEM "http://www.greenvulcano.com/gvesb/dtds/GVAdapters.dtd">

<GVAdapters version="1.0">
    <GVSQLErrorMapping name="SQL_ERROR_MAPPING" type="module">
        <DefaultMapping code="305">
            <CatalogMapping code="301" module="ORACLE FATAL">
                <SQLErrorCode code="3000"/>
                <SQLErrorCode code="3001"/>
                <SQLErrorCode code="3002"/>
            </CatalogMapping>
        </DefaultMapping>
        <CustomMapping caller="DATA HANDLER" code="313">
            <CatalogMapping code="318">
                <SQLErrorCode code="3000"/>
                <SQLErrorCode code="3001"/>
                <SQLErrorCode code="3002"/>
            </CatalogMapping>
        </CustomMapping>
    </GVSQLErrorMapping>
    <GVWebServices name="WEB_SERVICES" type="module" version="1.0">
        <GreenVulcanoWebServices/>
        <BusinessWebServices authenticated-http-soap-address="http://localhost:8080/gvaxis2/services"
                             authenticated-https-soap-address="https://localhost:8080/gvaxis2/services"
                             http-soap-address="http://localhost:8080/gvaxis2/services"
                             https-soap-address="https://localhost:8080/gvaxis2/services"
                             services-directory="${{gv.app.home}}/webservices/services"
                             wsdl-directory="${{gv.app.home}}/xmlconfig/wsdl"/>
        <UDDI>
            <JAXMLRegistry class="it.greenvulcano.gvesb.j2ee.xmlRegistry.impl.RegistryImpl"
                           id-registry="Registry" organization-name="GreenVulcano"
                           password="{3DES}siC67hYHbN4="
                           publish-url="http://localhost:8080/juddi/publish?wsdl"
                           query-url="http://localhost:8080/juddi/inquiry?wsdl"
                           type="xmlregistry" user-name="gvesb">
                <Description>Private JUDDI Registry</Description>
                <Properties>
                    <connectionFactory value="org.apache.ws.scout.registry.ConnectionFactoryImpl"/>
                    <connectionProperty name="javax.xml.registry.queryManagerURL"
                                        type="classproperty"
                                        value="http://localhost:8080/juddi/inquiry"/>
                    <connectionProperty name="javax.xml.registry.lifeCycleManagerURL"
                                        type="classproperty"
                                        value="http://localhost:8080/juddi/publish"/>
                    <connectionProperty name="javax.xml.registry.uddi.maxRows"
                                        type="classproperty" value="10"/>
                    <connectionProperty name="scout.proxy.transportClass"
                                        type="classproperty"
                                        value="org.apache.ws.scout.transport.AxisTransport"/>
                </Properties>
            </JAXMLRegistry>
        </UDDI>
        <AxisExtra>
            <PasswordCallback>
                <PwCbBasicHandler class="it.greenvulcano.gvesb.ws.rampart.policy.pwcb.PwCbBasicHandler"
                                  type="pwcb">
                </PwCbBasicHandler>
            </PasswordCallback>
        </AxisExtra>
    </GVWebServices>
    <GVJdbc name="JDBC" type="module">
        <Drivers>
            <Driver class="org.hsqldb.jdbcDriver" enabled="Yes" initType="static"
                    type="driver"/>
        </Drivers>
        <Connections>
            <Connection autoCommit="true" connectionMax="5" connectionMin="1"
                        connectionString="xmlp{{db.gv_test.url}}"
                        enabled="Yes" id="ds.test" password="xmlp{{db.gv_test.password}}"
                        txIsolation="TRANSACTION_NONE" type="connection" user="gv_test"/>
        </Connections>
    </GVJdbc>
    <GVJDBCConnectionBuilder name="GVJDBC" type="module">
        <DriverConnectionBuilder class="it.greenvulcano.gvesb.j2ee.db.connections.impl.DriverConnectionBuilder"
                                 driver-class="org.hsqldb.jdbcDriver" name="gv_test"
                                 password="xmlp{{db.gv_test.password}}"
                                 type="jdbc-connection-builder"
                                 url="xmlp{{db.gv_test.url}}"
                                 user="gv_test"/>
        <DataSourceConnectionBuilder class="it.greenvulcano.gvesb.j2ee.db.connections.impl.DataSourceConnectionBuilder"
                                     data-source-jndi="ds.gv_test" name="ds.gv_test"
                                     type="jdbc-connection-builder"/>
        <DriverPoolConnectionBuilder class="it.greenvulcano.gvesb.j2ee.db.connections.impl.DriverPoolConnectionBuilder"
                                     driver-class="org.hsqldb.jdbcDriver"
                                     name="pool_persistence" password="xmlp{{db.gv_pers.password}}"
                                     type="jdbc-connection-builder"
                                     url="xmlp{{db.gv_pers.url}}"
                                     user="gv_pers">
            <PoolParameters maxActive="10" maxIdle="5" minEvictableIdleTime="300"
                            minIdle="1" timeBetweenEvictionRuns="300">
                <validationQuery>select 1 from dual</validationQuery>
            </PoolParameters>
        </DriverPoolConnectionBuilder>
        <DriverPoolConnectionBuilder class="it.greenvulcano.gvesb.j2ee.db.connections.impl.DriverPoolConnectionBuilder"
                                     driver-class="org.hsqldb.jdbcDriver" name="gv_log"
                                     password="xmlp{{db.gv_log.password}}"
                                     type="jdbc-connection-builder"
                                     url="xmlp{{db.gv_log.url}}"
                                     user="gv_log">
            <PoolParameters maxActive="10" maxIdle="5" minEvictableIdleTime="300"
                            minIdle="1" timeBetweenEvictionRuns="300">
                <validationQuery>select 1 from dual</validationQuery>
            </PoolParameters>
        </DriverPoolConnectionBuilder>
        <DriverPoolConnectionBuilder class="it.greenvulcano.gvesb.j2ee.db.connections.impl.DriverPoolConnectionBuilder"
                                     driver-class="org.hsqldb.jdbcDriver" name="gv_stats"
                                     password="xmlp{{db.gv_stats.password}}" type="jdbc-connection-builder"
                                     url="xmlp{{db.gv_stats.url}}"
                                     user="gv_stats">
            <PoolParameters maxActive="10" maxIdle="5" minEvictableIdleTime="300"
                            minIdle="1" timeBetweenEvictionRuns="300">
                <validationQuery>select 1 from dual</validationQuery>
            </PoolParameters>
        </DriverPoolConnectionBuilder>
    </GVJDBCConnectionBuilder>
    <GVDataProviderManager name="GVDP" type="module">
        <DataProviders>
            <JMSBytesMessageDataProvider class="it.greenvulcano.gvesb.gvdp.impl.JMSBytesMessageDataProvider"
                                         name="WriteString_JMSBytesMessageDataProvider"
                                         type="dataProvider">
                <Field direction="OUT" key="output" type="field">
                    <Expression type="ognl"><![CDATA[writeBytes(#input.object.getBytes("UTF-8"))]]></Expression>
                </Field>
            </JMSBytesMessageDataProvider>
            <StringDataProvider class="it.greenvulcano.gvesb.gvdp.impl.StringDataProvider"
                                name="ReadString_JMSBytesMessageDataProvider"
                                type="dataProvider">
                <Field direction="INOUT" key="buffer" type="field">
                    <Expression type="ognl"><![CDATA[#bArr = new
byte[object.getBodyLength()], object.reset(),
object.readBytes(#bArr), new java.lang.String(#bArr, "UTF-8")]]></Expression>
                </Field>
            </StringDataProvider>
            <StringDataProvider class="it.greenvulcano.gvesb.gvdp.impl.StringDataProvider"
                                name="stringSerializeNodeDataProvider" type="dataProvider">
                <Field direction="INOUT" key="buffer" type="field">
                    <Expression type="ognl">@it.greenvulcano.util.xml.XMLUtils@serializeDOM_S(object)</Expression>
                </Field>
            </StringDataProvider>
            <CollectionDataProvider class="it.greenvulcano.gvesb.gvdp.impl.CollectionDataProvider"
                                    name="fileNamesCollectionDP" source-selector="object"
                                    type="dataProvider">
                <Field direction="INOUT" key="buffer" type="field">
                    <Expression type="xpath"><![CDATA[//FileList/File[@isDirectory='false']]]></Expression>
                </Field>
            </CollectionDataProvider>
            <Axis2MessageContextDataProvider class="it.greenvulcano.gvesb.gvdp.impl.Axis2MessageContextDataProvider"
                                             name="generic_RestDataProvider"
                                             type="dataProvider">
                <Field direction="OUT" key="message" type="field">
                    <Expression type="ognl">#dummy=""</Expression>
                </Field>
            </Axis2MessageContextDataProvider>
            <CollectionDataProvider class="it.greenvulcano.gvesb.gvdp.impl.CollectionDataProvider"
                                    name="StringSplitCollectionDP"
                                    source-selector="object" type="dataProvider">
                <Field direction="INOUT" key="buffer" type="field">
                    <Expression type="ognl"><![CDATA[split(",")]]></Expression>
                </Field>
            </CollectionDataProvider>
            <Axis2MessageContextDataProvider class="it.greenvulcano.gvesb.gvdp.impl.Axis2MessageContextDataProvider"
                                             name="genericPassBody_WSDataProvider"
                                             type="dataProvider">
                <Field direction="OUT" key="message" type="field">
                    <Expression type="ognl">envelope.body.addChild(@org.apache.axis2.util.XMLUtils@toOM(@it.greenvulcano.util.xml.XMLUtils@parseObject_S(#input.object, false, true).getDocumentElement()))</Expression>
                </Field>
            </Axis2MessageContextDataProvider>
            <Axis2MessageContextDataProvider class="it.greenvulcano.gvesb.gvdp.impl.Axis2MessageContextDataProvider"
                                             name="genericPassFullBody_WSDataProvider"
                                             type="dataProvider">
                <Field direction="OUT" key="message" type="field">
                    <Expression type="ognl"><![CDATA[#resBody = envelope.body,
#newBody = @org.apache.axis2.util.XMLUtils@toOM(@it.greenvulcano.util.xml.XMLUtils@parseObject_S(#input.object, false, true).getDocumentElement()),
#childs = #newBody.childElements,
#loop = :[#this != null &&
                ((#resBody.addChild(#this)) ,
                  #loop(#childs.hasNext ? #childs.next : null))
         ],
#loop(#childs.hasNext ? #childs.next : null)]]></Expression>
                </Field>
            </Axis2MessageContextDataProvider>
            <Axis2MessageContextDataProvider class="it.greenvulcano.gvesb.gvdp.impl.Axis2MessageContextDataProvider"
                                             name="genericPassEnvelopeOM_WSDataProvider"
                                             type="dataProvider">
                <Field direction="OUT" key="message" type="field">
                    <Expression type="ognl">envelope = #input.object</Expression>
                </Field>
            </Axis2MessageContextDataProvider>
        </DataProviders>
    </GVDataProviderManager>
    <GVDataHandlerConfiguration name="DH_ENGINE" type="module" version="1.0">
        <DBOBuilder class="it.greenvulcano.gvesb.datahandling.dbobuilder.DBOBuilder"
                    jdbc-connection-name="pool_persistence" name="ListRecoveryPoint"
                    type="dbobuilder">
            <DBOSelect class="it.greenvulcano.gvesb.datahandling.dbo.DBOSelect"
                       name="ListRecoveryPoint" transformation="ListRecoveryPoint"
                       type="dbo">
                <statement id="1" type="select"><![CDATA[select rec_id, id, server, system, service, operation, recovery_node, creation_date, update_date, state
from gv_recovery_point
where 1=1
decode{{@{{ID}}::NULL:: ::and id = '@{{ID}}'}}
decode{{@{{SERVICE}}::NULL:: ::and service = '@{{SERVICE}}'}}
decode{{@{{DATE}}::NULL:: ::and trunc(update_date) = to_date('@{{DATE}}', 'dd/mm/yyyy')}}
order by update_date desc]]></statement>
                <statement id="2" keys="1" type="select">select rec_id, name, value
from gv_recovery_property
order by rec_id, name</statement>
            </DBOSelect>
        </DBOBuilder>
        <DBOBuilder class="it.greenvulcano.gvesb.datahandling.dbobuilder.DBOBuilder"
                    jdbc-connection-name="pool_persistence" name="CheckRecoveryPoint"
                    type="dbobuilder">
            <DBOSelect class="it.greenvulcano.gvesb.datahandling.dbo.DBOSelect"
                       name="CheckRecoveryPoint" type="dbo">
                <statement id="1" type="select"><![CDATA[select count(1)
from gv_recovery_point
where rec_id = @{{REC_ID}}
and state = 'SAVED']]></statement>
            </DBOSelect>
        </DBOBuilder>
        <DBOBuilder class="it.greenvulcano.gvesb.datahandling.dbobuilder.DBOBuilder"
                    jdbc-connection-name="pool_persistence"
                    name="ListRecoveryPointServices" type="dbobuilder">
            <DBOSelect class="it.greenvulcano.gvesb.datahandling.dbo.DBOSelect"
                       name="ListRecoveryPointServices" type="dbo">
                <statement id="1" type="select"><![CDATA[select distinct service
from gv_recovery_point
decode{{@{{DATE}}::NULL:: ::where trunc(update_date) = to_date('@{{DATE}}', 'dd/mm/yyyy')}}
order by service]]></statement>
            </DBOSelect>
        </DBOBuilder>
        <DBOBuilder class="it.greenvulcano.gvesb.datahandling.dbobuilder.DBOBuilder"
                    jdbc-connection-name="pool_persistence" name="ListRecoveryPointIDs"
                    type="dbobuilder">
            <DBOSelect class="it.greenvulcano.gvesb.datahandling.dbo.DBOSelect"
                       name="ListRecoveryPointIDs" type="dbo">
                <statement id="1" type="select"><![CDATA[select distinct id
from gv_recovery_point
decode{{@{{DATE}}::NULL:: ::where trunc(update_date) = to_date('@{{DATE}}', 'dd/mm/yyyy')}}
order by id]]></statement>
            </DBOSelect>
        </DBOBuilder>
    </GVDataHandlerConfiguration>
    <GVExcelWorkbookConfiguration name="EXCEL_WORK" type="module" version="1.0">
        <GVExcelWorkbook configName="default" maxNumberOfSheets="50"
                         sheetDefaultName="Foglio">
            <SheetConfig offset="4">
                <Title columnsFromLeft="0" rowsFromTop="1">
                    <Format alignment="LEFT" hasBorder="false" maxWidth="50" minWidth="8">
                        <Font isBold="true" size="10" type="ARIAL"/>
                    </Format>
                </Title>
                <TableHeader>
                    <Format alignment="CENTRE" backgroundColour="GRAY_25" hasBorder="true"
                            maxWidth="30" scaleFactor="1.35">
                        <Font isBold="true" size="10" type="ARIAL"/>
                    </Format>
                </TableHeader>
                <TextColumn>
                    <Format alignment="LEFT" hasBorder="true" maxWidth="100"
                            scaleFactor="1.2">
                        <Font isBold="false" size="10" type="ARIAL"/>
                    </Format>
                </TextColumn>
                <DateColumn>
                    <Format alignment="CENTRE" hasBorder="true" maxWidth="30"
                            pattern="dd/MM/yyyy hh.mm.ss" scaleFactor="1.1">
                        <Font isBold="false" isItalic="true" size="10" type="ARIAL"/>
                    </Format>
                </DateColumn>
                <NumberColumn>
                    <Format alignment="RIGHT" hasBorder="true" maxWidth="30" minWidth="8"
                            pattern="@" scaleFactor="1">
                        <Font isBold="false" size="10" type="ARIAL"/>
                    </Format>
                </NumberColumn>
            </SheetConfig>
        </GVExcelWorkbook>
        <GVExcelWorkbook configName="report1" maxNumberOfSheets="12"
                         sheetDefaultName="Foglio">
            <SheetConfig offset="0">
                <Title columnsFromLeft="1" rowsFromTop="1">
                    <Format alignment="LEFT" backgroundColour="RED" hasBorder="false"
                            maxWidth="30">
                        <Font isBold="true" size="14" type="TIMES"/>
                    </Format>
                </Title>
                <TableHeader>
                    <Format alignment="CENTRE" backgroundColour="GRAY_25" hasBorder="true"
                            maxWidth="30" scaleFactor="1.3">
                        <Font isBold="true" size="10" type="ARIAL"/>
                    </Format>
                </TableHeader>
                <TextColumn>
                    <Format alignment="LEFT" hasBorder="true" maxWidth="40">
                        <Font isBold="false" size="10" type="ARIAL"/>
                    </Format>
                </TextColumn>
                <DateColumn>
                    <Format alignment="CENTRE" backgroundColour="WHITE" hasBorder="true"
                            maxWidth="30" pattern="dd/MM/yyyy hh:mm:ss" scaleFactor="1.1">
                        <Font isBold="false" isItalic="true" size="10" type="ARIAL"/>
                    </Format>
                </DateColumn>
                <NumberColumn>
                    <Format alignment="RIGHT" hasBorder="true" maxWidth="30" pattern="@"
                            scaleFactor="0.8">
                        <Font isBold="false" size="10" type="ARIAL"/>
                    </Format>
                </NumberColumn>
            </SheetConfig>
        </GVExcelWorkbook>
    </GVExcelWorkbookConfiguration>
    <GVExcelCreatorConfiguration name="EXCEL_REPO" type="module" version="1.0"/>
    <GVBIRTReportConfiguration name="BIRT_REPO" type="module" version="1.0">
        <Engine logLevel="INFO" reportEngineHome="${{gv.app.home}}/BIRTReportEngine">
            <Renders>
                <ExcelReportRender class="it.greenvulcano.birt.report.internal.ExcelReportRenderOptions"
                                   type="report-render"/>
                <PDFReportRender class="it.greenvulcano.birt.report.internal.PDFReportRenderOptions"
                                 type="report-render"/>
                <HTMLReportRender class="it.greenvulcano.birt.report.internal.HTMLReportRenderOptions"
                                  type="report-render"/>
            </Renders>
        </Engine>
        <ReportGroups>
            <ReportGroup name="GV Statistics">
                <Report config="GVStatistics.rptdesign" name="GV Statistics" type="report">
                    <Parameters>
                        <Parameter label="Analisys Date" name="REPORT_DATE"/>
                    </Parameters>
                </Report>
                <Report config="GVServiceStatistics.rptdesign"
                        name="GV Service Statistics" type="report">
                    <Parameters>
                        <Parameter label="Service" name="service"/>
                    </Parameters>
                </Report>
            </ReportGroup>
        </ReportGroups>
    </GVBIRTReportConfiguration>
    <RSHServiceClientConfiguration name="RSH_CLIENT" type="module" version="1.0">
        <RSHServiceClientLocal class="it.greenvulcano.gvesb.rsh.client.impl.RSHServiceClientLocal"
                               name="RSHLocal" type="rshClient"/>
        <RSHServiceClientRMI class="it.greenvulcano.gvesb.rsh.client.impl.RSHServiceClientRMI"
                             name="RSHRemote" regURL="rmi://localhost:3099"
                             type="rshClient"/>
    </RSHServiceClientConfiguration>
    <GVAdapterHttpConfiguration name="HTTP_ADAPTER" type="module" version="1.0">
        <InboundConfiguration>
            <ActionMappings/>
            <InboundTransactions/>
        </InboundConfiguration>
        <Formatters/>
    </GVAdapterHttpConfiguration>
    <GVHL7ListenerManager name="HL7_LISTENERS" type="module" version="1.0">
        <HL7Listeners/>
    </GVHL7ListenerManager>
    <GVRulesConfigManager name="RULES_CFG" type="module" version="1.0"/>
    <GVSocialAdapterManager name="GV_SOCIAL" type="module" version="1.0">
        <SocialAdapters>
            <TwitterSocialAdapter class="it.greenvulcano.gvesb.social.twitter.TwitterSocialAdapter"
                                  social="twitter" type="social-adapter">
                <Accounts>
                    <Account consumer_key="[CONS_KEY-CONS_KEY-CONS_KEY-]"
                             consumer_secret="[CONS_SECRET-CONS_SECRET-CONS_SECRET-CO]"
                             name="[ACCOUNT_NAME]"
                             twitteruserid="[USER_ID___]"/>
                </Accounts>
            </TwitterSocialAdapter>
        </SocialAdapters>
    </GVSocialAdapterManager>
    <GVPushNotificationManager name="PUSH_NOTIFICATION" type="module" version="1.0">
        <NotificationEngines/>
    </GVPushNotificationManager>
</GVAdapters>